{
  "version": 3,
  "file": "renderer.js",
  "sourceRoot": "../src/",
  "sources": [
    "renderer.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "{ipcRenderer} = require 'electron'\r\ngoogleIt = require 'google-it'\r\nDateFormat = require 'fast-date-format'\r\ndateFormat = new DateFormat 'hA, ddd DD MMM YYYY'\r\nduration = require('format-duration-time').default\r\nParser = require 'rss-parser'\r\nparser = new Parser()\r\ntwas = require 'twas'\r\nviz = null\r\nuser = null\r\naudioElm = document.querySelector 'audio'\r\ncurrentItem = null\r\ncurrentElm = null\r\ncurrentFeed = null\r\nautoplay = true\r\ndateFilter = 'week'\r\nstatusFilter = 'unlistened'\r\ndateFrom = new Date().valueOf() - 7 * 24 * 60 * 60 * 1000\r\ndateTo = Number.MAX_SAFE_INTEGER\r\nsort = 'pubDate'\r\nallItems = []\r\npodcasts = []\r\nlistens = null\r\nsortDir = -1\r\ndateRanges = [\r\n  time: 24 * 60 * 60 * 1000\r\n  name: 'Today'\r\n,\r\n  time: 48 * 60 * 60 * 1000\r\n  name: 'Yesterday'\r\n,\r\n  time: 7 * 24 * 60 * 60 * 1000\r\n  name: 'This week'\r\n,\r\n  time: 14 * 24 * 60 * 60 * 1000\r\n  name: 'Last week'\r\n,\r\n  time: 31 * 24 * 60 * 60 * 1000\r\n  name: 'This month'\r\n,\r\n  time: 62 * 24 * 60 * 60 * 1000\r\n  name: 'Last month'\r\n,\r\n  time: Number.MAX_SAFE_INTEGER\r\n  name: 'Older'\r\n]\r\n$items = document.querySelector('.items')\r\n$searchResults = document.querySelector('.search-results')\r\n$player = document.querySelector('.player')\r\n$playerPodTitle = document.querySelector('.player .pod .title')\r\n$playerFeedTitle = document.querySelector('.player .pod .feed-title')\r\n$playerImage = document.querySelector('.player .pod-image')\r\n$playerPositionCurrent = document.querySelector('.player .position .current')\r\n$playerPositionDuration = document.querySelector('.player .position .duration')\r\n$playerPrev = document.querySelector('.player .prev')\r\n$playerNext = document.querySelector('.player .next')\r\n$playerPlay = document.querySelector('.player .play')\r\n$playerStop = document.querySelector('.player .stop')\r\n$playerPositionBar = document.querySelector('.player .position .bar')\r\n$playerVolumeBar = document.querySelector('.player .volume .bar')\r\n$optionsSortForwards = document.querySelector('.option .forwards')\r\n$optionsSortBackwards = document.querySelector('.option .backwards')\r\n$filterWeek = document.querySelector('.sidebar .week')\r\n$filterMonth = document.querySelector('.sidebar .month')\r\n$filterAll = document.querySelector('.sidebar .all')\r\n$spinner = document.querySelector('.spinner')\r\n\r\ndebounce = (func, wait, immediate) ->\r\n  timeout = null\r\n  ->\r\n    context = @\r\n    args = arguments\r\n    later = ->\r\n      timeout = null\r\n      func.apply(context, args) if not immediate\r\n    callNow = immediate and not timeout\r\n    clearTimeout timeout\r\n    timeout = setTimeout later, wait\r\n    func.apply(context, args) if callNow\r\n    \r\nthrottle = (func, limit) ->\r\n  inThrottle = null\r\n  () ->\r\n    args = arguments\r\n    context = @\r\n    if not inThrottle\r\n      func.apply context, args\r\n      inThrottle = true\r\n      setTimeout ->\r\n        inThrottle = false\r\n      , limit\r\n      \r\nshowSpinner = ->\r\n  $spinner.style.display = 'block'\r\nhideSpinner = ->\r\n  $spinner.style.display = 'none'\r\n\r\nupdateDateFilter = (_dateFilter) ->\r\n  for filterBtn in document.querySelectorAll('.sidebar .date-filter .button')\r\n    filterBtn.className = filterBtn.className.replace /\\s*selected/g, ''\r\n  dateFilter = _dateFilter if _dateFilter\r\n  switch dateFilter\r\n    when 'week'\r\n      dateFrom = new Date().valueOf() - 7 * 24 * 60 * 60 * 1000\r\n    when 'month'\r\n      dateFrom = new Date().valueOf() - 31 * 24 * 60 * 60 * 1000\r\n    when 'all'\r\n      dateFrom = 0\r\n  document.querySelector('.sidebar .date-filter .' + dateFilter).className += ' selected'\r\nupdateStatusFilter = (_statusFilter) ->\r\n  for filterBtn in document.querySelectorAll('.sidebar .status-filter .button')\r\n    filterBtn.className = filterBtn.className.replace /\\s*selected/g, ''\r\n  statusFilter = _statusFilter if _statusFilter\r\n  document.querySelector('.sidebar .status-filter .' + statusFilter).className += ' selected'\r\nsetPageState = (state) ->\r\n  switch state\r\n    when 'search-results'\r\n      $items.style.display = 'none'\r\n      $searchResults.style.display = 'flex'\r\n    else\r\n      $items.style.display = 'flex'\r\n      $searchResults.style.display = 'none'\r\n\r\nsetupAudio = ->\r\n  el = document.querySelector 'audio'\r\n  audio = new AudioContext()\r\n  source = audio.createMediaElementSource el\r\n  bf = audio.createBiquadFilter()\r\n  bf.type = 'lowpass'\r\n  bf.frequency.setValueAtTime 20000, audio.currentTime\r\n  bf.gain.setValueAtTime -20, audio.currentTime\r\n  analyser = audio.createAnalyser()\r\n  analyser.fftSize = 2048\r\n  viz = require('./viz') analyser\r\n  source.connect bf\r\n  .connect analyser\r\n  .connect audio.destination\r\n  \r\ndoReportListenStatus = (context) ->\r\n  console.log 'report listen status'\r\n  ipcRenderer.send context + '-listen',\r\n    url: currentItem.url\r\n    pubDate: new Date(currentItem.pubDate).valueOf()\r\n    time: audioElm.currentTime\r\n    percent: audioElm.currentTime / audioElm.duration * 100\r\n    date: new Date().valueOf()\r\n  \r\nreportListenStatus = throttle doReportListenStatus, 30000\r\n\r\naudioElm.ontimeupdate = (e) ->\r\n  console.log 'calling rls'\r\n  reportListenStatus 'app'\r\n  renderPlayer()\r\n\r\naudioElm.onended = (e) ->\r\n  doReportListenStatus 'global'\r\n  next()\r\n\r\naudioElm.onplay = (e) ->\r\n  renderPlayer()\r\n\r\naudioElm.onpause = (e) ->\r\n  doReportListenStatus 'global'\r\n  renderPlayer()\r\n\r\nformatDuration = (duration) ->\r\n  return '' if not duration\r\n  pad = (num,length) ->\r\n    (new Array(length).fill(0).join('') + num).slice(num.toString().length)\r\n  duration.replace /(.*?):(.*?):(.*)/, (all, hours, mins) ->\r\n    +hours + 'h' + pad(+mins, 2) + 'm'\r\n    \r\nsanitize = (text) ->\r\n  text.replace /[^\\d^\\w]+/g, '' if text\r\n  \r\nrenderSidebar = ->\r\n  podHTML = ''\r\n  for podcast in podcasts\r\n    if currentFeed\r\n      if podcast.url is currentFeed\r\n        podHTML = '<div class=\"pod-image\" style=\"background-image:url(' + (podcast.itunes?.image or podcast.image?.url or podcast.items[0].itunes?.image) + ')\"></div><h2>' + podcast.title + '</h2><p>' + podcast.description + '</p>'\r\n    else\r\n      podHTML += '<a onclick=\"renderer.showFeed(\\'' + podcast.url + '\\')\" style=\"background-image:url(' + (podcast.itunes?.image or podcast.image?.url or podcast.items[0].itunes?.image) + ')\"></a>'\r\n  document.querySelector('.sidebar .podcasts').innerHTML = podHTML\r\nrenderItems = ->\r\n  html = ''\r\n  for range in dateRanges\r\n    range.used = false\r\n  for item in allItems\r\n    age = new Date().valueOf() - new Date(item.pubDate).valueOf()\r\n    for range in dateRanges\r\n      if age < range.time\r\n        if not range.used\r\n          range.used = true\r\n          html += '<div class=\"date-range\">' + range.name + '</div>'\r\n        break\r\n    html += '<div class=\"item ' + sanitize(item.enclosure?.url) + '\"><a onclick=\"renderer.play(\\'' + item.enclosure?.url + '\\')\"><div class=\"image\" style=\"background-image: url(' + (item.itunes?.image or item.feed.itunes?.image or item.feed.image?.url) + ')\" /></div><div class=\"details\"><div class=\"fade\"></div><div class=\"title\">' + item.title + '</div><div class=\"pod-details\"><div class=\"pod-title\" onclick=\"renderer.showFeed(\\'' + item.feed.url + '\\', event)\">' + item.feed.title + '</div><div class=\"date\">' + dateFormat.format(new Date(item.pubDate)) + '</div></div><div class=\"summary\">' + item.contentSnippet + '</div><div class=\"duration\">' + formatDuration(item.itunes?.duration) + '</div></div></a></div>'\r\n  document.querySelector('.items').innerHTML = html\r\n  \r\nrenderPodcasts = (_podcasts) ->\r\n  return if not ((_podcasts or podcasts) and listens)\r\n  console.log 'start'\r\n  setPageState 'items'\r\n  allItems = []\r\n  for podcast in (_podcasts or podcasts)\r\n    continue if currentFeed and currentFeed isnt podcast.url\r\n    for item in podcast.items\r\n      item.feed = podcast\r\n      if item.enclosure?.url\r\n        for listen in listens\r\n          if listen.url is item.enclosure.url\r\n            item.time = listen.time\r\n            item.percent = listen.percent\r\n            break\r\n    allItems = allItems.concat podcast.items\r\n  allItems = allItems.filter (item) ->\r\n    return true if currentItem and currentItem.url is item.url\r\n    if dateFrom < new Date(item.pubDate).valueOf() < dateTo\r\n      if item.percent and item.percent > 5\r\n        item.listened = true\r\n        return statusFilter is 'listened' or statusFilter is 'all'\r\n      else\r\n        return statusFilter is 'unlistened' or statusFilter is 'all'\r\n    false\r\n  allItems.sort (a, b) ->\r\n    if new Date(a[sort]) > new Date(b[sort]) then sortDir else sortDir * -1\r\n  renderItems()\r\n  setPlayState()\r\n  \r\nchangeSort = ->\r\n  sortDir = -sortDir\r\n  await renderPodcasts()\r\n  renderPlayer()\r\n  \r\nsetDateFilter = (filter) ->\r\n  updateDateFilter filter\r\n  await renderPodcasts()\r\n  renderPlayer()\r\n  renderSidebar()\r\n  \r\nsetStatusFilter = (filter) ->\r\n  updateStatusFilter filter\r\n  await renderPodcasts()\r\n  renderPlayer()\r\n  renderSidebar()\r\n  \r\n\r\nmain = ->\r\n  setupAudio()\r\n  ipcRenderer.send 'get-user'\r\n  ipcRenderer.on 'user', (win, _user) ->\r\n    user = _user\r\n    #ipcRenderer.send 'get-podcasts'\r\n    console.log 'user', user\r\n  ipcRenderer.on 'podcast', (win, _podcast) ->\r\n    console.log 'podcast', _podcast\r\n  ipcRenderer.on 'podcasts', (win, data) ->\r\n    console.log data\r\n    podcasts = data.podcasts\r\n    listens = data.listens\r\n    renderPodcasts data.podcasts\r\n    updateDateFilter()\r\n    updateStatusFilter()\r\n    renderSidebar()\r\n  ipcRenderer.on 'listens', (win, _listens) ->\r\n    listens = _listens\r\n    renderPodcasts()\r\n  setInterval ->\r\n    ipcRenderer.send 'check-for-new'\r\n  , 10 * 1000\r\nmain()\r\n\r\nfetchPodcast = (url) ->\r\n  console.log 'fetch pod', url\r\n  new Promise (resolve, reject) ->\r\n    returned = false\r\n    setTimeout ->\r\n      if not returned\r\n        returned = true\r\n        resolve null\r\n    , 10000\r\n    try\r\n      podcast = await parser.parseURL url\r\n    if not returned\r\n      returned = true\r\n      resolve podcast\r\n\r\nfetchRssFeeds = (query, results) ->\r\n  if not results\r\n    results = await googleIt\r\n      query: query\r\n  #podcasts = []\r\n  for result in results\r\n    #if /xml(\\W|$)/.test result.link\r\n    podcast = null\r\n    try\r\n      podcast = await fetchPodcast result.link\r\n    if podcast and podcast.items and podcast.items.length\r\n      podcast.feedUrl = result.link\r\n      #podcasts.push podcast\r\n      $searchResults.innerHTML += '<div class=\"item search-result\"><div class=\"image\" style=\"background-image: url(' + (podcast.itunes?.image or podcast.image?.url or podcast.items[0].itunes?.image) + ')\" /></div><div class=\"details\"><div class=\"title\">' + podcast.title + '</div><div class=\"timeago\">' + twas(new Date(podcast.items[0].pubDate)) + '</div><a class=\"show-episodes\" onclick=\"renderer.showPodcastEpisodes(event, \\'' + podcast.feedUrl + '\\')\">Show episodes</a><a class=\"add-podcast\" onclick=\"renderer.addPodcast(\\'' + podcast.feedUrl + '\\')\">Add to my podcasts</a><div class=\"description\">' + podcast.description + '</div></div></div>'\r\n\r\nsearchPodcasts = (e) ->\r\n  e.preventDefault()\r\n  #show search results\r\n  $searchResults.innerHTML = ''\r\n  setPageState 'search-results'\r\n  showSpinner()\r\n  #set to searching\r\n  await fetchRssFeeds '', [link:document.querySelector('#add-podcast').value]\r\n  await fetchRssFeeds document.querySelector('#add-podcast').value + ' podcast rss'\r\n  await fetchRssFeeds document.querySelector('#add-podcast').value + ' podcast filetype:xml'\r\n  #ipcRenderer.send 'add-podcast', document.querySelector('#add-podcast').value\r\n  hideSpinner()\r\n  return false\r\n  \r\naddPodcast = (url) ->\r\n  ipcRenderer.send 'add-podcast', url\r\n  \r\nrenderPlayer = ->\r\n  if sortDir < 0\r\n    $optionsSortForwards.style.display = 'block'\r\n    $optionsSortBackwards.style.display = 'none'\r\n  else\r\n    $optionsSortForwards.style.display = 'none'\r\n    $optionsSortBackwards.style.display = 'block'\r\n  if currentItem and currentItem.feed\r\n    $playerPodTitle.innerText = currentItem.title\r\n    $playerFeedTitle.innerText = currentItem.feed.title\r\n    $playerImage.style.backgroundImage = 'url(' + currentItem.itunes?.image + ')'\r\n    if audioElm.duration\r\n      $playerPositionCurrent.innerText = duration(audioElm.currentTime, 's').format('h:mm:ss')\r\n      $playerPositionDuration.innerText = duration(audioElm.duration, 's').format('h:mm:ss')\r\n      $playerPositionBar.style.width = (audioElm.currentTime / audioElm.duration * 100) + '%'\r\n    else\r\n      $playerPositionCurrent.innerText = ''\r\n      $playerPositionDuration.innerText = ''\r\n      $playerPositionBar.style.width = '0%'\r\n    $playerVolumeBar.style.width = (audioElm.volume * 100) + '%'\r\n    if audioElm.paused\r\n      $playerPlay.style.display = 'block'\r\n      $playerStop.style.display = 'none'\r\n    else\r\n      $playerPlay.style.display = 'none'\r\n      $playerStop.style.display = 'block'\r\n    if currentItem.prev\r\n      $playerPrev.style.visibility = 'visible'\r\n    else\r\n      $playerPrev.style.visibility = 'hidden'\r\n    if currentItem.next\r\n      $playerNext.style.visibility = 'visible'\r\n    else\r\n      $playerNext.style.visibility = 'hidden'\r\n      \r\nclearPlayState = (elm) ->\r\n  elm.className = elm.className.replace /\\s*playing|\\s*paused/g, '' if elm\r\nsetPlayState = ->\r\n  if currentItem\r\n    clearPlayState currentElm if currentElm\r\n    currentElm = document.querySelector '.' + sanitize(currentItem.url)\r\n    if currentElm\r\n      clearPlayState currentElm\r\n      currentElm.className += ' playing'\r\n      currentElm.scrollIntoViewIfNeeded()\r\n\r\nplay = (url) ->\r\n  if url\r\n    if currentItem?.url is url and not audioElm.paused\r\n      return stop()\r\n    if currentItem?.url isnt url\r\n      for item, i in allItems\r\n        if item.enclosure?.url is url\r\n          currentItem = item\r\n          currentItem.url = url\r\n          currentItem.reported = false\r\n          currentItem.prev = allItems[i - 1]\r\n          currentItem.next = allItems[i + 1]\r\n          audioElm.src = url\r\n          if item.time\r\n            audioElm.currentTime = item.time\r\n          break\r\n  if currentItem\r\n    clearPlayState currentElm\r\n    setPlayState()\r\n    audioElm.volume = 0.1\r\n    audioElm.play()\r\n    $player.style.display = 'flex'\r\n  else\r\n    play allItems[0]?.enclosure?.url\r\nstop = ->\r\n  if currentItem\r\n    clearPlayState currentElm\r\n    currentElm.className += ' paused'\r\n    audioElm.pause()\r\n    \r\nsetVolume = (e) ->\r\n  audioElm.volume = e.layerX / e.srcElement.offsetWidth\r\n  renderPlayer()\r\n\r\nsetPosition = (e) ->\r\n  audioElm.currentTime = e.layerX / e.srcElement.offsetWidth * audioElm.duration\r\n  \r\nprev = ->\r\n  if audioElm.currentTime > 5\r\n    return play currentItem.url\r\n  play currentItem.prev?.enclosure?.url if currentItem?.prev\r\nnext = ->\r\n  play currentItem.next?.enclosure?.url if currentItem?.next\r\n  \r\nshowPodcastEpisodes = (event, feedUrl) ->\r\n  event.stopPropagation()\r\n  console.log 'show pod episodes', feedUrl\r\n  for podcast in podcasts\r\n    if podcast.feedUrl is feedUrl\r\n      console.log 'got podcast'\r\n      return renderPodcasts [podcast]\r\n      \r\nshowFeed = (url, event) ->\r\n  event.stopPropagation() if event\r\n  currentFeed = url\r\n  setPageState 'feed'\r\n  sort = 'pubDate'\r\n  sortDir = -1\r\n  setDateFilter 'all'\r\n  \r\nshowSubscriptions = ->\r\n  currentFeed = null\r\n  setPageState 'subscriptions'\r\n  sort = 'pubDate'\r\n  sortDir = -1\r\n  setDateFilter 'week'\r\n  \r\ngetChannel = ->\r\n  ipcRenderer.send 'get-channel'\r\n  \r\njoinChannel = ->\r\n  ipcRenderer.send 'join-channel'\r\n      \r\ndraw = ->\r\n  requestAnimationFrame draw\r\n  viz.draw() if viz\r\ndraw()\r\n  \r\nmodule.exports =\r\n  addPodcast: addPodcast\r\n  searchPodcasts: searchPodcasts\r\n  play: play\r\n  stop: stop\r\n  setVolume: setVolume\r\n  setPosition: setPosition\r\n  prev: prev\r\n  next: next\r\n  showPodcastEpisodes: showPodcastEpisodes\r\n  changeSort: changeSort\r\n  setDateFilter: setDateFilter\r\n  setStatusFilter: setStatusFilter\r\n  showFeed: showFeed\r\n  showSubscriptions: showSubscriptions\r\n  getChannel: getChannel\r\n  joinChannel: joinChannel"
  ]
}